<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Kubeflow for Mac | Documentation</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="Documentation">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.d74e1dbf.css" as="style"><link rel="preload" href="/assets/js/app.780d1361.js" as="script"><link rel="preload" href="/assets/js/2.c5541352.js" as="script"><link rel="preload" href="/assets/js/1.f1fda117.js" as="script"><link rel="preload" href="/assets/js/14.9fc40335.js" as="script"><link rel="prefetch" href="/assets/js/10.ce14c990.js"><link rel="prefetch" href="/assets/js/11.3c6d9b95.js"><link rel="prefetch" href="/assets/js/12.e0654671.js"><link rel="prefetch" href="/assets/js/13.1ce757f8.js"><link rel="prefetch" href="/assets/js/15.2d1b17a9.js"><link rel="prefetch" href="/assets/js/16.c5a57d5e.js"><link rel="prefetch" href="/assets/js/17.fef59687.js"><link rel="prefetch" href="/assets/js/18.5cf32ab8.js"><link rel="prefetch" href="/assets/js/19.34204f89.js"><link rel="prefetch" href="/assets/js/20.24f07836.js"><link rel="prefetch" href="/assets/js/21.7f8f7869.js"><link rel="prefetch" href="/assets/js/22.3f20ce36.js"><link rel="prefetch" href="/assets/js/23.a4908e7f.js"><link rel="prefetch" href="/assets/js/24.9dda1fe4.js"><link rel="prefetch" href="/assets/js/25.c34e09f3.js"><link rel="prefetch" href="/assets/js/26.60b4ed72.js"><link rel="prefetch" href="/assets/js/27.2e71fd14.js"><link rel="prefetch" href="/assets/js/3.64ae4e2d.js"><link rel="prefetch" href="/assets/js/4.1ccc4a49.js"><link rel="prefetch" href="/assets/js/5.c3c3bf69.js"><link rel="prefetch" href="/assets/js/6.72b52443.js"><link rel="prefetch" href="/assets/js/7.eb6d59c3.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.9f962556.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d74e1dbf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Documentation</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Guide</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/" aria-current="page" class="sidebar-link">Docker Desktop for Mac</a></li><li><a href="/guide/kubeflow.html" aria-current="page" class="active sidebar-link">Kubeflow for Mac</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/kubeflow.html#prerequisites" class="sidebar-link">Prerequisites</a></li><li class="sidebar-sub-header"><a href="/guide/kubeflow.html#installation" class="sidebar-link">Installation</a></li><li class="sidebar-sub-header"><a href="/guide/kubeflow.html#issues" class="sidebar-link">Issues</a></li><li class="sidebar-sub-header"><a href="/guide/kubeflow.html#test" class="sidebar-link">Test</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="kubeflow-for-mac"><a href="#kubeflow-for-mac" class="header-anchor">#</a> Kubeflow for Mac</h1> <h2 id="prerequisites"><a href="#prerequisites" class="header-anchor">#</a> Prerequisites</h2> <p>Kubeflow needs the following tools to be installed in the system before the setup</p> <ul><li>Docker</li> <li>Kubernetes</li> <li>Kustomize</li></ul> <p>Since we have already installed Docker Desktop and also enabled Kubernetes in our previous step, we should continue installing Kustomize to proceed with the setup of Kubeflow</p> <h2 id="installation"><a href="#installation" class="header-anchor">#</a> Installation</h2> <h3 id="step-1"><a href="#step-1" class="header-anchor">#</a> Step 1</h3> <p>Let's install Kustomize using HomeBrew for mac. There are installation options for other operating systems as specified here
<a href="https://kubectl.docs.kubernetes.io/installation/kustomize/" target="_blank" rel="noopener noreferrer">Kustomize<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language- extra-class"><pre class="language-text"><code>brew install kustomize
</code></pre></div><p><img src="/assets/img/kustomize_install.bdc00730.png" alt="Image from images folder"></p> <h3 id="step-2"><a href="#step-2" class="header-anchor">#</a> Step 2</h3> <p>Let's install <a href="https://kind.sigs.k8s.io/" target="_blank" rel="noopener noreferrer">Kind<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> using HomeBrew for mac. Kind supports running local kubernetes clusters on Docker</p> <div class="language- extra-class"><pre class="language-text"><code>brew install kind
</code></pre></div><p><img src="/assets/img/kind_install.b6235c80.png" alt="Image from images folder"></p> <h3 id="step-3"><a href="#step-3" class="header-anchor">#</a> Step 3</h3> <p>Let's create a Kind cluster with the following yaml content (Includes 2 worker nodes)</p> <div class="language- extra-class"><pre class="language-text"><code>cat &lt;&lt;EOF | kind create cluster --name=kubeflow  --kubeconfig mycluster.yaml --config=-
kind: Cluster
apiVersion: kind.x-k8s.io/v1alpha4
nodes:
- role: control-plane
  kubeadmConfigPatches:
  - |
    kind: ClusterConfiguration
    apiServer:
      extraArgs:
        &quot;service-account-issuer&quot;: &quot;kubernetes.default.svc&quot;
        &quot;service-account-signing-key-file&quot;: &quot;/etc/kubernetes/pki/sa.key&quot;
- role: worker
- role: worker
EOF
</code></pre></div><p>The above step should be creating a kind cluster as shown below</p> <p><img src="/assets/img/kind_cluster.601a8efa.png" alt="Image from images folder"></p> <h3 id="step-4"><a href="#step-4" class="header-anchor">#</a> Step 4</h3> <p>Save kubeconfig - This step is to ensure that all config data is stored in a backup file</p> <div class="language- extra-class"><pre class="language-text"><code>mv ~/.kube/config ~/.kube/config_backup
kind get kubeconfig --name kubeflow &gt; ~/.kube/config
</code></pre></div><p>Both the above steps should run without any issues / output content</p> <h3 id="step-5"><a href="#step-5" class="header-anchor">#</a> Step 5</h3> <p>Create a secret based on existing credentials in order to pull the images (Update the --from-file parameter to include the full path)</p> <div class="language- extra-class"><pre class="language-text"><code>docker login
kubectl create secret generic regcred \
    --from-file=.dockerconfigjson=~/.docker/config.json \
    --type=kubernetes.io/dockerconfigjson
</code></pre></div><h3 id="step-6"><a href="#step-6" class="header-anchor">#</a> Step 6</h3> <p>Clone the kubeflow's manifest repository</p> <div class="language- extra-class"><pre class="language-text"><code>git clone https://github.com/kubeflow/manifests.git
</code></pre></div><p><img src="/assets/img/Kubeflow_manifest_clone.d403b30e.png" alt="Image from images folder"></p> <p>Change to the manifest folder</p> <div class="language- extra-class"><pre class="language-text"><code>cd manifests
</code></pre></div><p>You should be able to see the following (or similar) files as shown below</p> <p><img src="/assets/img/Kubeflow_manifest_folder.a75839ac.png" alt="Image from images folder"></p> <h3 id="step-7"><a href="#step-7" class="header-anchor">#</a> Step 7</h3> <p>Build and apply the YAML files for all kubeflow components. This step will install all Kubeflow official components (residing under apps) and all common services (residing under common)</p> <div class="language- extra-class"><pre class="language-text"><code>while ! kustomize build example | kubectl apply -f -; do echo &quot;Retrying to apply resources&quot;; sleep 10; done
</code></pre></div><p>The above command should run for sometime to complete setting up the kubeflow components.</p> <p>At the end, all the kubeflow pods should be up and runnings as shown below</p> <p><img src="/assets/img/Kubeflow_pods_running.9dc7d800.png" alt="Image from images folder"></p> <p>Verify if all the pods are ready by individually checking them with the names below</p> <div class="language- extra-class"><pre class="language-text"><code>kubectl get pods -n cert-manager
kubectl get pods -n istio-system
kubectl get pods -n auth
kubectl get pods -n knative-eventing
kubectl get pods -n knative-serving
kubectl get pods -n kubeflow
kubectl get pods -n kubeflow-user-example-com
</code></pre></div><h2 id="issues"><a href="#issues" class="header-anchor">#</a> Issues</h2> <p>I did end up with several pods unable to run due to missing images for the Apple silicon arm64 architecture. I had to update the image tags and also rebuild the kserve/models-web-app into a separate docker image and host it on my repository</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Update the tags from v1.8.0-rc.0 to v1.8.0 for the following images</p> <p>Please go into the app and common folders and update the <b>kustomization.yaml</b> file to update the tags</p> <ul><li>kubeflownotebookswg/centraldashboard</li> <li>kubeflownotebookswg/poddefaults-webhook</li> <li>kubeflownotebookswg/jupyter-web-app</li> <li>kubeflownotebookswg/notebook-controller</li> <li>kubeflownotebookswg/profile-controller</li> <li>kubeflownotebookswg/kfam</li> <li>kubeflownotebookswg/pvcviewer-controller</li> <li>kubeflownotebookswg/tensorboard-controller</li> <li>kubeflownotebookswg/tensorboards-web-app</li> <li>kubeflownotebookswg/volumes-web-app</li> <li>kserve/models-web-app</li></ul> <p>For the kserve/models-web-app, clone the public repository <a href="https://github.com/kserve/models-web-app.git" target="_blank" rel="noopener noreferrer">https://github.com/kserve/models-web-app.git<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and build the docker image with the below commands</p> <div class="language- extra-class"><pre class="language-text"><code>docker build -t &lt;any org&gt;/models-web-app:v1.0.0 .

docker push &lt;any org&gt;/models-web-app:v1.0.0

</code></pre></div><p>Also update the following files in the Kubeflow manifest's repository to reflect the new image</p> <ul><li>contrib/kserve/models-web-app/base/deployment.yaml</li> <li>contrib/kserve/models-web-app/base/kustomization.yaml</li></ul> <p>Below are some handy commands to look at the pods and inspect the errors for corrective actions</p> <div class="language- extra-class"><pre class="language-text"><code>kubectl get pods -A
kubectl describe pod --namespace=kubeflow &lt;podname&gt;
</code></pre></div></div> <h2 id="test"><a href="#test" class="header-anchor">#</a> Test</h2> <p>One last step to access the Kubeflow's built-in Dashboard is to use the kubectl proxy to forward the requests through the istio-ingressgateway service in the istio-system namespace.</p> <div class="language- extra-class"><pre class="language-text"><code>kubectl port-forward svc/istio-ingressgateway -n istio-system 9090:80
</code></pre></div><p>You should be able to see like below</p> <p><img src="/assets/img/Kubeflow_dashboard_proxy.e53e4afe.png" alt="Image from images folder"></p> <p>The Login screen for the Kubeflow dashboard should appear like below once the proxy starts working</p> <p><img src="/assets/img/Kubeflow_dashboard_login.99b901a7.png" alt="Image from images folder"></p> <p>Once you login with the following credentials, you should be able to see the dashboard</p> <div class="language- extra-class"><pre class="language-text"><code>user@example.com
12341234
</code></pre></div><p><img src="/assets/img/Kubeflow_dashboard.7bdbc1cd.png" alt="Image from images folder"></p> <p>Tried opening a Jupyter Notebook and its able to launch as shown below</p> <p><img src="/assets/img/kubeflow_jupyter_notebook.1f4a47a5.png" alt="Image from images folder"></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>At this point in time, I'm not sure how the credentials are stored / updated but the dashboard does take some time to show up and also apply the namespace</p> <p>I was put on the kubeflow-user-example-com namespace by default</p> <p>Also, the Jupyter Notebook requires worker nodes to be setup as its launched as a separate pod</p> <ul><li>Our kind cluster configuration takes care of this requirement by adding 2 worker nodes</li></ul></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/guide/" class="prev router-link-active">
        Docker Desktop for Mac
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.780d1361.js" defer></script><script src="/assets/js/2.c5541352.js" defer></script><script src="/assets/js/1.f1fda117.js" defer></script><script src="/assets/js/14.9fc40335.js" defer></script>
  </body>
</html>
